[合集 \- 学术工作效率(78\)](https://github.com)[1\.安装Amos结构方程模型分析软件的方法2023\-04\-28](https://github.com/fkxxgis/p/17361092.html)[2\.如何不显示我的电脑、回收站等图标？2023\-05\-05](https://github.com/fkxxgis/p/17374220.html)[3\.SPSS计算极值、平均值、中位数、方差、偏度、峰度、变异系数2023\-05\-08](https://github.com/fkxxgis/p/17380874.html)[4\.无需代码绘制人工神经网络ANN模型结构图的方法2023\-05\-10](https://github.com/fkxxgis/p/17388010.html)[5\.论文的技术路线流程图如何绘制？2023\-05\-19](https://github.com/fkxxgis/p/17415852.html)[6\.电脑缩放异常、显示亮度无法调整的处理办法2023\-06\-06](https://github.com/fkxxgis/p/17460286.html)[7\.EndNote参考文献格式Output Styles界面介绍2023\-06\-08](https://github.com/fkxxgis/p/17466615.html)[8\.Windows电脑环境变量（用户变量、系统变量）的修改2023\-07\-13](https://github.com/fkxxgis/p/17551129.html)[9\.如何修改电脑的BIOS密码？2023\-07\-22](https://github.com/fkxxgis/p/17573049.html)[10\.叶绿素含量测定仪SPAD\-502怎么使用？2023\-07\-29](https://github.com/fkxxgis/p/17589360.html)[11\.全球都有哪些高光谱遥感卫星？2023\-08\-19](https://github.com/fkxxgis/p/17642359.html)[12\.创建Anaconda虚拟Python环境的方法2023\-09\-09](https://github.com/fkxxgis/p/17689044.html)[13\.Anaconda虚拟环境配置Python库与Spyder编译器2023\-10\-14](https://github.com/fkxxgis/p/17764012.html)[14\.小提琴图的绘制方法：Python matplotlib实现2023\-10\-16](https://github.com/fkxxgis/p/17768423.html)[15\.如何用CAN\-EYE获取植被参数数据？2023\-10\-22](https://github.com/fkxxgis/p/17780287.html)[16\.ArcMap属性表出现乱码情况的解决2023\-10\-27](https://github.com/fkxxgis/p/17793250.html)[17\.考研保研、夏令营推免的简历模板2023\-12\-15](https://github.com/fkxxgis/p/17904071.html)[18\.安装MicroStation软件、Terrasolid插件的方法2024\-01\-22](https://github.com/fkxxgis/p/17979805)[19\.VMware虚拟机部署Linux Ubuntu系统的方法2024\-01\-24](https://github.com/fkxxgis/p/17984211)[20\.在Linux Ubuntu系统中部署C\+\+环境与Visual Studio Code软件2024\-01\-26](https://github.com/fkxxgis/p/17989213)[21\.安装Visual Studio的详细流程2024\-01\-28](https://github.com/fkxxgis/p/17992830)[22\.获取Visual Studio所用MSVC编译器版本：\_MSC\_VER数值2024\-01\-29](https://github.com/fkxxgis/p/17994267)[23\.Visual Studio部署C\+\+矩阵库Armadillo的方法2024\-01\-30](https://github.com/fkxxgis/p/17996838)[24\.如何在Visual Studio新C\+\+项目中调用之前配置过的库？2024\-01\-31](https://github.com/fkxxgis/p/17999171)[25\.在Visual Studio中部署GDAL库的C\+\+版本（包括SQLite、PROJ等依赖）2024\-02\-01](https://github.com/fkxxgis/p/18001061)[26\.C\+\+遴选出特定类型的文件或文件名符合要求的文件2024\-02\-02](https://github.com/fkxxgis/p/18002898)[27\.初步上手Git软件及GitHub平台：基本操作方法2024\-02\-05](https://github.com/fkxxgis/p/18007732)[28\.下载、安装Git并拷贝GitHub项目到本地的流程2024\-02\-06](https://github.com/fkxxgis/p/18009535)[29\.Visual Studio部署matplotlib绘图库的C\+\+版本2024\-02\-07](https://github.com/fkxxgis/p/18010863)[30\.Anaconda与Python环境在Windows中的部署2024\-03\-01](https://github.com/fkxxgis/p/18046420)[31\.Windows配置R语言、RStudio开发环境2024\-03\-03](https://github.com/fkxxgis/p/18049611)[32\.Visual Studio部署C\+\+环境下OpenCV库2024\-03\-06](https://github.com/fkxxgis/p/18055869)[33\.ArcMap的mxd文件没有数据、显示感叹号怎么办？2024\-03\-22](https://github.com/fkxxgis/p/18088768)[34\.绘制三元图、颜色空间图：R语言代码2024\-03\-27](https://github.com/fkxxgis/p/18098190)[35\.Linux电脑如何下载QGIS？2024\-03\-29](https://github.com/fkxxgis/p/18103916)[36\.Python表格处理模块xlrd在Anaconda中的安装2024\-04\-01](https://github.com/fkxxgis/p/18109161)[37\.Postman模拟浏览器网页请求并获取网页数据2024\-04\-03](https://github.com/fkxxgis/p/18112668)[38\.多次复制Excel符合要求的数据行：Python批量实现2024\-04\-08](https://github.com/fkxxgis/p/18120657)[39\.电脑开机时报错No Bootable Device找不到索引的解决方法2024\-04\-12](https://github.com/fkxxgis/p/18131223):[slowerssr加速器](https://slowerss.com)[40\.论文研究区域图的制作方法：ArcGIS2024\-04\-17](https://github.com/fkxxgis/p/18139839)[41\.修改中文、英文参考文献在文末列表中的顺序：EndNote2024\-04\-19](https://github.com/fkxxgis/p/18145575)[42\.ArcPy自动绘制大量地图并设置地图要素：Python2024\-04\-22](https://github.com/fkxxgis/p/18150594)[43\.Python提取文本文件（.txt）数据的方法2024\-05\-24](https://github.com/fkxxgis/p/18210950)[44\.将大量文件的拓展名中大写字母改为小写：Python实现2024\-05\-25](https://github.com/fkxxgis/p/18212290)[45\.浏览器打开JupyterLab后所有快捷键与窗口按键均失效怎么办？2024\-05\-27](https://github.com/fkxxgis/p/18215335)[46\.将编译过的C\+\+库迅速部署在Visual Studio新项目中2024\-05\-28](https://github.com/fkxxgis/p/18217914)[47\.EndNote里参考文献的期刊名显示错误怎么办？2024\-05\-29](https://github.com/fkxxgis/p/18220217)[48\.找出长时序遥感影像的缺失日期并用像素均为0的栅格填充缺失日期的文件2024\-05\-31](https://github.com/fkxxgis/p/18225102)[49\.Python依据遥感影像的分幅筛选出对应的栅格文件2024\-06\-01](https://github.com/fkxxgis/p/18225883)[50\.Python结合文件名称将多个文件复制到不同路径下2024\-06\-05](https://github.com/fkxxgis/p/18232851)[51\.mklink命令使得OneDrive同步任意一个文件夹2024\-06\-16](https://github.com/fkxxgis/p/18250917)[52\.在Ubuntu系统安装Anaconda及Python2024\-06\-18](https://github.com/fkxxgis/p/18254161)[53\.GIS数据获取：土地利用与土壤属性、DEM、水体水系数据2024\-06\-25](https://github.com/fkxxgis/p/18267371)[54\.配置h5py、netCDF4库的方法：Anaconda环境2024\-06\-26](https://github.com/fkxxgis/p/18269668)[55\.核对不同文件夹所含内容的差异并提取缺失内容：Python代码2024\-07\-03](https://github.com/fkxxgis/p/18281105)[56\.坚果云与floccus实现Chrome书签国内跨设备、跨平台同步2024\-07\-06](https://github.com/fkxxgis/p/18287538)[57\.基于FileZilla上传、下载服务器数据的方法2024\-07\-09](https://github.com/fkxxgis/p/18292769)[58\.Python按条件筛选、剔除表格数据并绘制剔除前后的直方图2024\-07\-20](https://github.com/fkxxgis/p/18312992)[59\.R语言基于表格文件的数据绘制具有多个系列的柱状图与直方图2024\-07\-22](https://github.com/fkxxgis/p/18315885)[60\.Linux服务器PBS任务队列作业提交脚本的使用方法2024\-07\-26](https://github.com/fkxxgis/p/18325140)[61\.Python按条件删除Excel表格数据的方法2024\-08\-09](https://github.com/fkxxgis/p/18350610)[62\.PowerShell快速修改多个文件的名称2024\-08\-14](https://github.com/fkxxgis/p/18359761)[63\.用whl文件安装Anaconda中的GDAL2024\-08\-17](https://github.com/fkxxgis/p/18364819)[64\.ArcGIS创建渔网工具的使用方法2024\-08\-26](https://github.com/fkxxgis/p/18381647)[65\.Python自动复制Excel数据：将各行分别重复指定次数2024\-09\-01](https://github.com/fkxxgis/p/18391303)[66\.Python批量分割Excel后逐行做差、合并文件的方法2024\-09\-03](https://github.com/fkxxgis/p/18395379)[67\.Python将表格文件中某些列的数据整体向上移动一行2024\-09\-09](https://github.com/fkxxgis/p/18404400)[68\.GIS转码的秋招历程与踩坑经历2024\-09\-22](https://github.com/fkxxgis/p/18425502)[69\.通过MobaXterm操作远程服务器电脑的方法2024\-09\-27](https://github.com/fkxxgis/p/18435640)[70\.将ASD光谱仪的.asd文件转为文本文件2024\-10\-01](https://github.com/fkxxgis/p/18443134)[71\.搜广推算法校招面试：BOSS直聘 推荐搜索系统工程师2024\-10\-08](https://github.com/fkxxgis/p/18451628)[72\.查找大量时序遥感文件缺失、不连贯的成像日期：Python代码2024\-10\-14](https://github.com/fkxxgis/p/18463655)[73\.华为校招三轮面经：通用软件开发工程师2024\-11\-03](https://github.com/fkxxgis/p/18523746)[74\.合并具有文本框的Word文档：VBA代码批量操作2024\-11\-16](https://github.com/fkxxgis/p/18549418)[75\.ArcGIS填补面图层的细小空白并删除主体部分外的零散部分2024\-11\-23](https://github.com/fkxxgis/p/18564889)[76\.开启Word、Excel、PPT时速度很慢的一种解决方法2024\-12\-21](https://github.com/fkxxgis/p/18621500)[77\.基于高德地图API在Python中实现地图功能的方法01\-01](https://github.com/fkxxgis/p/18646044)78\.Python在多个Excel文件中找出缺失数据行数多的文件01\-08收起
  本文介绍基于**Python**语言，针对一个**文件夹**下大量的**Excel**表格文件，基于其中**每一个文件**内、**某一列数据**的特征，对其加以筛选，并将**符合要求**与**不符合要求**的文件分别复制到另外**两个新的文件夹**中的方法。


  首先，我们来明确一下本文的具体需求。现有一个文件夹，其中有大量的**Excel**表格文件（在本文中我们就以`csv`格式的文件为例）；如下图所示。


![image](https://img2024.cnblogs.com/blog/3080295/202501/3080295-20250108212521495-1415437434.png)


  其中，每一个**Excel**表格文件都有着如下图所示的数据格式。


![](https://img2024.cnblogs.com/blog/3080295/202501/3080295-20250108212515212-1142301856.png)


  如上图所示，各个文件都有着这样的问题——有些行的数据是无误的，而有些行，除了第一列，其他列都是`0`值。因此，我们希望就以第`2`列为标准，找出含有`0`值数量**低于或高于某一阈值**的表格文件——其中，`0`值数量多，肯定不利于我们的分析，我们将其放入一个新的文件夹；而`0`值数量少的，我们才可以对这一表格文件加以后续的分析，我们就将其放入另一个新的文件夹中。因此，计算出每一个表格文件对应的的`0`值数量百分比后，我们就进一步将这一**Excel**表格文件复制到对应的文件夹内。


  知道了需求，我们就可以开始代码的撰写。其中，本文用到的代码如下所示。



```
# -*- coding: utf-8 -*-
"""
Created on Tue May 16 20:19:50 2023

@author: fkxxgis
"""

import os
import shutil
import pandas as pd

def filter_copy_files(original_path, useful_path, useless_path, threshold):
    original_all_file = os.listdir(original_path)
    for file in original_all_file:
        path = os.path.join(original_path, file)
        if file.endswith(".csv") and os.path.isfile(path):
            df = pd.read_csv(path)
            column_value = df.iloc[:, 1]
            zero_count = (column_value == 0).sum()
            zero_ratio = zero_count / len(column_value)
            
            if zero_ratio < threshold:
                new_path = os.path.join(useful_path, file)
                shutil.copy(path, new_path)
            else:
                new_path = os.path.join(useless_path, file)
                shutil.copy(path, new_path)

filter_copy_files("E:/01_Reflectivity/99_Model_Training/00_Data/02_Extract_Data/13_AllYearAverage",
                  "E:/01_Reflectivity/99_Model_Training/00_Data/02_Extract_Data/14_PointSelection/LowMissingRate",
                  "E:/01_Reflectivity/99_Model_Training/00_Data/02_Extract_Data/14_PointSelection/HighMissingRate",
                  0.30)

```

  其中，上述代码是一个筛选并复制文件的函数。该函数的目的是根据给定的阈值将具有不同缺失率的文件从一个文件夹复制到另外两个文件夹。


  在代码中，`filter_copy_files`函数接受四个参数：


* `original_path`：原始文件夹的路径，其中包含要筛选的`.csv`文件。
* `useful_path`：有用文件的目标文件夹路径，将满足阈值要求（也就是`0`值数量低于阈值）的文件复制到此处。
* `useless_path`：无用文件的目标文件夹路径，将不满足阈值要求（也就是`0`值数量高于阈值）的文件复制到此处。
* `threshold`：阈值，用于确定文件的缺失率是否满足要求。


  函数首先使用`os.listdir`获取原始文件夹中的所有文件名，然后遍历每个文件名。对于以`.csv`结尾且为文件的文件，函数使用`pd.read_csv`读取`.csv`文件，并通过`df.iloc[:, 1]`获取第`2`列的值。


  接下来，函数计算第`2`列中为零的元素数量，并通过将其除以列的总长度来计算缺失率。根据阈值判断缺失率是否满足要求。


  如果缺失率小于阈值，函数将文件复制到`useful_path`目标文件夹中，使用`shutil.copy`函数实现复制操作。否则，函数将文件复制到`useless_path`文件夹中。


  最后，我们调用了`filter_copy_files`函数，并传递了相应的参数来执行文件筛选和复制操作。


  运行上述代码，我们即可在对应的文件夹中看到文件。如下图所示，`0`值数量低于阈值的表格文件都复制到了这个`LowMissingRate`文件夹中，我们即可对其加以后续处理；而那些`0`值数量高于阈值的表格文件，就放到另一个`HighMissingRate`文件夹中了。


![](https://img2024.cnblogs.com/blog/3080295/202501/3080295-20250108212515208-198197653.png)


  至此，大功告成。


